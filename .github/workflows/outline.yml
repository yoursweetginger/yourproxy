name: Install Outline server
on:
  workflow_dispatch:
    inputs:
      ssh_user:
        description: Username for ssh connection
        default: root
      ssh_pass:
        description: Password for ssh connection
        required: true
      ssh_host:
        description: Host for ssh connection
        required: true
jobs:
  Deploy:
    runs-on: ubuntu-20.04
    env:
      SSH_USER: "{{ inputs.ssh_user }}"
      SSH_PASS: "{{ inputs.ssh_pass }}"
      SSH_HOST: "{{ inputs.ssh_host }}"
      SSH_COMMAND: 'sudo bash -c "$(wget -qO- https://raw.githubusercontent.com/Jigsaw-Code/outline-server/master/src/server_manager/install_scripts/install_server.sh)"'
    steps:
      - name: Send a command to install via ssh
        run: "sshpass -p ::add-mask::$SSH_PASS ssh $SSH_USER@$SSH_PASS $SSH_COMMAND"
